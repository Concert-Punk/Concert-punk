<!DOCTYPE html>
<<<<<<< HEAD
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
=======
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
>>>>>>> 2c9adc71493ceabbcd10ce0b9b0284aa3c70ae19

<head>
    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.js"
            integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE=" crossorigin="anonymous"></script>


    <title></title>
</head>
<style>
    .nav-link {
        color: rgba(12, 105, 128, 0.99);
    }

    .btn-outline-success {
        color: rgba(12, 105, 128, 0.99);
    }

    h1 {
        color: rgba(12, 105, 128, 0.99);
    }
    * { box-sizing: border-box; }
    .video-background {
        background: #000;
        position: fixed;
        top: 0; right: 0; bottom: 0; left: 0;
        z-index: -99;
    }
</style>


<nav th:fragment="navbar">
    <div style="background-color: rgb(0,0,0)">
        <div style="justify-content: center">
            <h1>Concert Punk</h1>
        </div>
        <form class="navbar navbar-expand-lg">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
            </div>
            <div class="nav-item">
                <a class="nav-link" href="/sign-up">Sign up</a>
            </div>
            <div class="nav-item">
                <a class="nav-link" href="/login">Login</a>
            </div>
            <div class="nav-item">
                <a class="nav-link" href="/profile">Profile</a>
            </div>
            <div class="nav-item">
                <a class="nav-link" href="/users/viewFollowers">Following</a>
            </div>
            <div class="nav-item">
                <a class="nav-link" href="/events/create">Create new event</a>
            </div>

            <form>
                <label for="search-input"></label><input id="search-input" type="text" name="Search Artist"/>
                <input id="add-artist" type="submit" value="Search"/>
            </form>
        </form>
    </div>


</nav>

<body>

<h1>Welcome Concert Punk</h1>


<body>
<h1><em>Local Events</em></h1>
<!--Container-->
<div class="container">
    <!-- Images Container -->
    <div class="probablywontwork"></div>
</div>

</body>

<br>
<br>
<br>
<br>

<h1><em>Search Results</em></h1>
<!--<form>-->
<!--    <label for="search-input"></label><input id="search-input" type="text" name="Search Artist"/>-->
<!--    <input id="add-artist" type="submit" value="Search"/>-->
<!--</form>-->
<div class="container">
    <div class="row">
        <div class="col s12" id="mainContent">
            <h1><em><span id="displayArtist"></span></em></h1>
            <div class="title"><h1><em>Top Tracks</em></h1></div>
        </div>
        <div id="tracksContainer">
        </div>
        <div id="musicSample">
        </div>
        <div class="title"><h1><em>Concert Schedule</em></h1></div>
    </div>

    <p id="concertSchedule">
    </p>
    <br>
    <br>
    <div class="title">YouTube Video</div>
    <p><span id="youTube"></span></p>
    <br>
    <div class="title">Related Artists</div>
    <div id="relatedArtistContainer"></div>
    <br>
</div>

<script src="/keys.js"></script>

<!--spotify script-->
<script type="text/javascript" src="/js/spotify.js"></script>

<!--youtube script-->
<script type="text/javascript" src="/js/youAPI.js"></script>

<!--ticketmaster script-->
<script type="text/javascript" src="/js/ticketMasterAPI.js"></script>

<!--Moments JS is a framework that can parse,validate,manipulate and display dates-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" integrity="sha512-qTXRIMyZIFb8iQcfjXWCO8+M5Tbc38Qi5WzdPOYZHIlZpzBHG3L3by84BBBOiRGiEb7KKtAOAs5qYdUiZiQNNQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="/isLoggedIn.js"></script>

<script>
    $.ajax({
        type: "GET",
        url: "https://api.seatgeek.com/2/events?client_id=MjM5OTczOTd8MTYzNDY3MzY2Ni42ODE5ODE&geoip=true",
        async: true,
        dataType: "json",
        success: function (data) {
            let cardMaker = ''
            let concerts = data.events.filter(element => element.type === 'concert');
            console.log(concerts)
            for (const concerts of data.events.filter(element => element.type === 'concert')) {
                let image = concerts.performers[0].image
                let ticketPurchaseUrl = concerts.url
                let artistIndex = concerts.title
                console.log(artistIndex);
                cardMaker += "<div class='d-inline-block'>"
                cardMaker += ` <div class='card' style='width: 18rem;'>`
                cardMaker += `<a id="url" href="${ticketPurchaseUrl}"><img class="card-img-top" src='${image}' alt=' img'></a>`
                cardMaker += `<div class='card-body'><h2> <strong>${concerts.title}</strong> </h2> </div>`;
                cardMaker += `<div class='card-text'><h3> @${concerts.venue.name}</h3> </div>`;
                //   cardMaker +=`<div class="card-text"><p>${concerts.performers.genres.name}</p>`
                cardMaker += `<div class='card-text'><p>${concerts.datetime_local}</p></div>`;
                if (userIsLoggedIn) {
                    cardMaker += `<div><button class="saveEvent" data-id="${concerts.id}" type="submit">Save</button></div>
    </div><br>`
                }

<<<<<<< HEAD
                cardMaker += "</div>";
                console.log(userIsLoggedIn);
            }
            $(".probablywontwork").html(cardMaker)
            addListener();
        },
        error: function (xhr, status, err) {
        }
    });



    function addListener() {
        $('.saveEvent').click(function (e) {

            e.preventDefault();
            var events_id = ($(this).data("id"));
            console.log(events_id)

            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");
            console.log(token);
            console.log(header);
            console.log(events_id);
            var data = events_id;
            //Remove all errors
            $.ajax({
                type: "GET",
                url: `https://api.seatgeek.com/2/events/${events_id}?client_id=MjM5OTczOTd8MTYzNDY3MzY2Ni42ODE5ODE&geoip=true`,
                async: true,
                dataType: "json",
                success: function (res) {
                    console.log(res)

                    const savedEvent = {
                        api_id: res.id,
                        title: res.title,
                        location: res.venue.name,
                        startTime: res.datetime_local,
                    }
                    saveEvent(savedEvent);
                }
            })


            function saveEvent(eventFromAPI) {
                $.post({
                    url: '/saveEvent',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify(eventFromAPI),
                    beforeSend: function (jqXHR) {
                        jqXHR.setRequestHeader('X-CSRF-Token', token,)
                    },
                    dataType: "json",
                    success: function (html) {
                        console.log(html);
                    }
                });
            }
        })
    }



</script>



=======
    $.ajax({
        type: "GET",
        url: "https://api.seatgeek.com/2/events?client_id=MjM5OTczOTd8MTYzNDY3MzY2Ni42ODE5ODE&geoip=true",
        async: true,
        dataType: "json",
        success: function (data) {
            let cardMaker = ''
            let concerts = data.events.filter(element => element.type === 'concert');
            console.log(concerts)
            for (const concerts of data.events.filter(element => element.type === 'concert')) {
                let image = concerts.performers[0].image
                let ticketPurchaseUrl = concerts.url
                let artistIndex = concerts.title
                console.log(artistIndex);
                cardMaker += "<div class='d-inline-block'>"
                cardMaker += ` <div class='card' style='width: 18rem;'>`
                cardMaker += `<a id="url" href="${ticketPurchaseUrl}"><img class="card-img-top" src='${image}' alt=' img'></a>`
                cardMaker += `<div class='card-body'><h2> <strong>${concerts.title}</strong> </h2> </div>`;
                cardMaker += `<div class='card-text'><h3> @${concerts.venue.name}</h3> </div>`;
                //   cardMaker +=`<div class="card-text"><p>${concerts.performers.genres.name}</p>`
                cardMaker += `<div class='card-text'><p>${concerts.datetime_local}</p></div>
</div><br>`
                cardMaker += "</div>";
            }
            $(".probablywontwork").html(cardMaker)
        },
        error: function (xhr, status, err) {
        }
    });
>>>>>>> 2c9adc71493ceabbcd10ce0b9b0284aa3c70ae19

</script>

</body>
</html>